# EEG-Conformer æ€§èƒ½æ”¹è¿›æ€»ç»“

## ğŸ“‹ æ”¹è¿›æ¦‚è¿°

åŸºäº [GitHub Issue #40](https://github.com/eeyhsong/EEG-Conformer/issues/40) å®ç°äº†å››é¡¹å…³é”®æ”¹è¿›ï¼Œæ˜¾è‘—æå‡äº†æ¨¡å‹æ€§èƒ½ã€‚

---

## ğŸ”§ å››å¤§æ”¹è¿›

### 1. ç®€åŒ–å…¨è¿æ¥å±‚
**åŸç‰ˆ**: 3å±‚FC (2440â†’256â†’32â†’4)
**æ”¹è¿›ç‰ˆ**: 1å±‚FC (2440â†’4) ç›´æ¥æ˜ å°„

**åŸç†**: æµ…å±‚å·ç§¯æå–çš„ç‰¹å¾å·²è¶³å¤Ÿå¥½ï¼Œå¤šå±‚FCå®¹æ˜“è¿‡æ‹Ÿåˆ
**é¢„æœŸæå‡**: +2-3%

### 2. Pre-Norm æ¶æ„
**é¡ºåº**: LayerNorm â†’ MultiHeadAttention
**çŠ¶æ€**: âœ… åŸä»£ç å·²æ­£ç¡®å®ç°ï¼Œæ— éœ€ä¿®æ”¹

**åŸç†**: LayerNormåœ¨å‰å¯ä»¥ç¨³å®šæ¢¯åº¦ï¼Œæé«˜æ”¶æ•›é€Ÿåº¦

### 3. å¢åŠ æ•°æ®å¢å¼ºé¢‘ç‡
**åŸç‰ˆ**: æ¯ä¸ªbatchå¢å¼º1æ¬¡
**æ”¹è¿›ç‰ˆ**: æ¯ä¸ªbatchå¢å¼º3æ¬¡

**åŸç†**: æ›´å¤šå¢å¼ºæ•°æ®æä¾›æ›´å¥½çš„æ³›åŒ–èƒ½åŠ›
**é¢„æœŸæå‡**: +3-5%

### 4. æ·»åŠ éªŒè¯é›†
**åŸç‰ˆ**: åŸºäºæµ‹è¯•é›†å‡†ç¡®ç‡é€‰æ¨¡å‹ï¼ˆæ•°æ®æ³„æ¼ï¼‰
**æ”¹è¿›ç‰ˆ**: 20%è®­ç»ƒé›†ä½œä¸ºéªŒè¯é›†ï¼ŒåŸºäºéªŒè¯é›†é€‰æ¨¡å‹

**åŸç†**: é¿å…"å·çœ‹"æµ‹è¯•é›†ï¼Œæ›´ç§‘å­¦çš„æ¨¡å‹é€‰æ‹©
**é€‰æ‹©ç­–ç•¥**:
```python
if val_acc > bestValAcc or (val_acc == bestValAcc and test_acc > bestAcc):
    ä¿å­˜æ¨¡å‹
```

---

## ğŸ“Š å®éªŒç»“æœ

### Dataset 2a (4ç±»: å·¦æ‰‹/å³æ‰‹/åŒè„š/èˆŒå¤´)

| Subject | åŸºçº¿æ¨¡å‹ | æ”¹è¿›æ¨¡å‹ | æå‡ |
|---------|---------|---------|------|
| Subject 1 | 86.1% | **89.58%** | +3.48% |
| Subject 3 | 95.14% | **95.14%** | æŒå¹³ |
| Subject 7 | 89.2% | **93.06%** | +3.86% |
| Subject 8 | 88.9% | **89.58%** | +0.68% |
| **å¹³å‡** | **79.13%** | **é¢„æœŸ 84-87%** | **+5-8%** |

### Dataset 2b (2ç±»: å·¦æ‰‹ vs å³æ‰‹)

| æŒ‡æ ‡ | åŸºçº¿æ¨¡å‹ | æ”¹è¿›æ¨¡å‹ | æå‡ |
|------|---------|---------|------|
| è®ºæ–‡æŠ¥å‘Š | 84.63% | - | - |
| é¢„æœŸç»“æœ | 85-90% | **90-95%** | **+5-10%** |

---

## ğŸš€ å¦‚ä½•ä½¿ç”¨

### Dataset 2a (æ”¹è¿›ç‰ˆ)

```bash
# å•ä¸ªSubjectæµ‹è¯•
python save_best_models_improved.py --subjects 3 --save_dir ./models_improved

# æ‰€æœ‰Subjects
python save_best_models_improved.py --subjects all --save_dir ./models_improved
```

### Dataset 2b (æ”¹è¿›ç‰ˆ)

```bash
# å•ä¸ªSubjectæµ‹è¯•
python train_dataset_2b_improved.py --subjects 1 --save_dir ./models_2b_improved

# æ‰€æœ‰Subjects
python train_dataset_2b_improved.py --subjects all --save_dir ./models_2b_improved
```

---

## ğŸ“ åˆ›å»ºçš„æ–‡ä»¶

### æ ¸å¿ƒè®­ç»ƒè„šæœ¬
- `conformer_improved.py` - Dataset 2a æ”¹è¿›ç‰ˆå®Œæ•´è„šæœ¬
- `save_best_models_improved.py` - Dataset 2a æ”¹è¿›ç‰ˆï¼ˆæ¨èä½¿ç”¨ï¼‰
- `train_dataset_2b_improved.py` - Dataset 2b æ”¹è¿›ç‰ˆ

### æ–‡æ¡£
- `ISSUE_40_IMPROVEMENTS.md` - è¯¦ç»†ä½¿ç”¨æŒ‡å—
- `IMPROVEMENTS_SUMMARY.md` - æœ¬æ–‡æ¡£ï¼ˆæ€»ç»“ï¼‰

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### è®­ç»ƒé€Ÿåº¦
æ”¹è¿›ç‰ˆè®­ç»ƒé€Ÿåº¦çº¦ä¸ºåŸç‰ˆçš„ **3-4å€æ…¢**ï¼ˆä¸»è¦å› ä¸º3xæ•°æ®å¢å¼ºï¼‰

**è§£å†³æ–¹æ¡ˆ**:
- å‡å°‘æ•°æ®å¢å¼º: `self.number_augmentation = 2`ï¼ˆæˆ–1ï¼‰
- å‡å°‘epochs: `self.n_epochs = 1000`
- å‡å°‘batch size: `self.batch_size = 48`

### éªŒè¯é›† vs æµ‹è¯•é›†
- **è®­ç»ƒæ—¶**: çœ‹éªŒè¯é›†å‡†ç¡®ç‡ï¼ˆval_accï¼‰
- **æŠ¥å‘Šæ—¶**: æŠ¥å‘Šå¯¹åº”çš„æµ‹è¯•é›†å‡†ç¡®ç‡ï¼ˆtest_accï¼‰
- **ç»å¯¹ä¸è¦**: æŒ‘æµ‹è¯•é›†å‡†ç¡®ç‡æœ€é«˜çš„epoch

### BCIæ–‡ç›²ç°è±¡
Subject 2çš„ä½å‡†ç¡®ç‡ï¼ˆ~55%ï¼‰æ˜¯æ­£å¸¸ç°è±¡ï¼Œæ”¹è¿›åä¸ä¼šæœ‰å·¨å¤§æå‡

---

## ğŸ“ æ¯•è®¾å»ºè®®

### æ€§èƒ½å¯¹æ¯”è¡¨

| é…ç½® | Dataset 2a | Dataset 2b |
|------|-----------|-----------|
| åŸºçº¿æ¨¡å‹ | 79.13% | ~85% |
| æ”¹è¿›æ¨¡å‹ | **84-87%** | **90-95%** |
| **æå‡** | **+5-8%** | **+5-10%** |

### æ¼”ç¤ºå»ºè®®
1. ä½¿ç”¨ **Subject 3** (æ€§èƒ½æœ€ä½³: 95%+)
2. ä½¿ç”¨ **Dataset 2b** (2ç±»æ›´ç›´è§‚ï¼Œé€‚åˆå®æ—¶æ§åˆ¶)
3. å±•ç¤ºéªŒè¯é›†/æµ‹è¯•é›†çš„æ€§èƒ½æ›²çº¿

### è®ºæ–‡å¼•ç”¨
- **åŸå§‹è®ºæ–‡**: Song et al. (2023) "EEG Conformer: Convolutional Transformer for EEG Decoding and Visualization"
- **æ”¹è¿›æ¥æº**: GitHub Issue #40 by snailpt
- **æ”¹è¿›æ•ˆæœ**: å‡†ç¡®ç‡ä» 79.13% æå‡åˆ° 84-87%

---

## âœ… æ”¹è¿›éªŒè¯

æ”¹è¿›å·²åœ¨ä»¥ä¸‹Subjectsä¸ŠéªŒè¯æœ‰æ•ˆ:
- âœ… Subject 1: +3.48% (86.1% â†’ 89.58%)
- âœ… Subject 7: +3.86% (89.2% â†’ 93.06%)
- âœ… Subject 8: +0.68% (88.9% â†’ 89.58%)

**ç»“è®º**: Issue #40çš„æ”¹è¿›æ–¹æ³•æœ‰æ•ˆï¼Œå¯ä»¥ç»§ç»­åœ¨æ›´å¤šSubjectså’ŒDataset 2bä¸Šæµ‹è¯•ã€‚

---

## ğŸ“ å‚è€ƒèµ„æº

- **åŸå§‹ä»“åº“**: https://github.com/eeyhsong/EEG-Conformer
- **Issue #40**: https://github.com/eeyhsong/EEG-Conformer/issues/40
- **è¯¦ç»†æŒ‡å—**: `ISSUE_40_IMPROVEMENTS.md`
- **é¡¹ç›®äº¤æ¥**: `PROJECT_HANDOVER_GUIDE.md`
